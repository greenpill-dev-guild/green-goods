---
description: Cross-package import principles and patterns
globs:
  - "packages/*/src/**/*.ts"
  - "packages/*/src/**/*.tsx"
alwaysApply: false
---

# Cross-Package Imports

Rules for importing code across packages in the Green Goods monorepo.

## Architectural Boundaries

```
packages/
├── shared/     ← Central code (hooks, providers, stores, modules)
├── client/     ← Consumes shared, NO local hooks/stores
├── admin/      ← Consumes shared, NO local hooks/stores
├── contracts/  ← Solidity + deployment artifacts
├── indexer/    ← Envio GraphQL
└── agent/      ← Telegram/Discord bot
```

## Import Rules

### ✅ Allowed

```typescript
// Client/Admin importing from shared
import { useAuth, useRole, queryKeys } from "@green-goods/shared";
import { AppProvider, JobQueueProvider } from "@green-goods/shared";
import { workToasts, mediaResourceManager } from "@green-goods/shared";
import type { Garden, Work } from "@green-goods/shared";

// Client/Admin importing contract artifacts
import deployment from "../../../contracts/deployments/84532-latest.json";
import GardenABI from "../../../contracts/out/Garden.sol/Garden.json";
```

### ❌ Forbidden

```typescript
// Source code imports across packages
import { helper } from "../../client/src/utils/helper";
import { Component } from "../../admin/src/components/Foo";

// Deep imports from shared
import { useAuth } from "@green-goods/shared/src/hooks/auth/useAuth";
```

## What Lives in Shared

| Type | Location | Purpose |
|------|----------|---------|
| **Hooks** | `src/hooks/` | ALL hooks |
| **Providers** | `src/providers/` | Auth, JobQueue, Work, App |
| **Stores** | `src/stores/` | Zustand stores |
| **Modules** | `src/modules/` | Core business logic |
| **Types** | `src/types/` | ALL domain types (explicit imports) |
| **Utils** | `src/utils/` | Utility functions |
| **Config** | `src/config/` | Chain, blockchain config |
| **i18n** | `src/i18n/` | Translations |

## Type Import Pattern (Required)

**ALL domain types must be explicitly imported:**

```typescript
// ✅ Correct - explicit imports
import type { Garden, Work, Action, Job, WorkJobPayload } from '@green-goods/shared';

// ❌ Wrong - relying on global types
const garden: Garden = { ... }; // Don't assume globals
```

**See:** `.cursor/rules/type-system.mdc` for complete type guidelines.

## What Stays in Packages

| Package | Keeps | Reason |
|---------|-------|--------|
| **Client** | Components, views | Different UX patterns |
| **Admin** | Components, views | Different UX patterns |
| **Contracts** | Solidity source | Build tool specific |
| **Indexer** | Event handlers | Envio-specific |

## Key Principle

> **If logic is used by both client and admin, it must live in shared.**

This ensures:
- Single source of truth
- No duplicate code
- Consistent behavior
- Easier testing

## Adding New Shared Code

1. Create in `packages/shared/src/{category}/`
2. Export from `packages/shared/src/{category}/index.ts`
3. Re-export from `packages/shared/src/index.ts`
4. Import in packages from `@green-goods/shared`

## Reference

- Hook architecture: `.cursor/rules/hook-architecture.mdc`
- State patterns: `.cursor/rules/state-patterns.mdc`
- Monorepo rules: `/.cursor/rules/monorepo.mdc`
