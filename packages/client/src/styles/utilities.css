@import "tailwindcss";

@theme {
  /* Basic shadows */
  --shadow-regular-xs: 0 1px 2px 0 rgba(10, 13, 20, 0.03);
  --shadow-regular-sm: 0 2px 4px rgba(27, 28, 29, 0.04);
  --shadow-regular-md: 0 16px 32px -12px rgba(14, 18, 27, 0.1);

  /* Button focus shadows */
  --shadow-button-primary-focus: 0 0 0 2px var(--color-bg-white-0), 0 0 0 4px
    var(--color-primary-alpha-10);
  --shadow-button-important-focus: 0 0 0 2px var(--color-bg-white-0), 0 0 0 4px
    var(--color-neutral-alpha-16);
  --shadow-button-error-focus: 0 0 0 2px var(--color-bg-white-0), 0 0 0 4px
    var(--color-red-alpha-10);

  /* Fancy button shadows */
  --shadow-fancy-buttons-neutral: 0 1px 2px 0 rgba(27, 28, 29, 0.48), 0 0 0 1px #242628;
  --shadow-fancy-buttons-primary: 0 1px 2px 0 rgba(14, 18, 27, 0.24), 0 0 0 1px
    var(--color-primary-base);
  --shadow-fancy-buttons-error: 0 1px 2px 0 rgba(14, 18, 27, 0.24), 0 0 0 1px
    var(--color-error-base);
  --shadow-fancy-buttons-stroke: 0 1px 3px 0 rgba(14, 18, 27, 0.12), 0 0 0 1px
    var(--color-stroke-soft-200);

  /* Component-specific shadows */
  --shadow-toggle-switch: 0 6px 10px 0 rgba(14, 18, 27, 0.06), 0 2px 4px 0 rgba(14, 18, 27, 0.03);
  --shadow-switch-thumb: 0 4px 8px 0 rgba(27, 28, 29, 0.06), 0 2px 4px 0 rgba(14, 18, 27, 0.08);
  --shadow-tooltip: 0 12px 24px 0 rgba(14, 18, 27, 0.06), 0 1px 2px 0 rgba(14, 18, 27, 0.03);
}

@layer utilities {
  .image-lut {
    @apply contrast-110 brightness-105 saturate-150;
  }

  /* Usage examples in utility classes */
  .shadow-regular-xs {
    box-shadow: var(--shadow-regular-xs);
  }

  .shadow-regular-sm {
    box-shadow: var(--shadow-regular-sm);
  }

  .shadow-regular-md {
    box-shadow: var(--shadow-regular-md);
  }

  .shadow-button-primary-focus {
    box-shadow: var(--shadow-button-primary-focus);
  }

  .shadow-button-important-focus {
    box-shadow: var(--shadow-button-important-focus);
  }

  .shadow-button-error-focus {
    box-shadow: var(--shadow-button-error-focus);
  }

  .shadow-fancy-buttons-neutral {
    box-shadow: var(--shadow-fancy-buttons-neutral);
  }

  .shadow-fancy-buttons-primary {
    box-shadow: var(--shadow-fancy-buttons-primary);
  }

  .shadow-fancy-buttons-error {
    box-shadow: var(--shadow-fancy-buttons-error);
  }

  .shadow-fancy-buttons-stroke {
    box-shadow: var(--shadow-fancy-buttons-stroke);
  }

  .shadow-toggle-switch {
    box-shadow: var(--shadow-toggle-switch);
  }

  .shadow-switch-thumb {
    box-shadow: var(--shadow-switch-thumb);
  }

  .shadow-tooltip {
    box-shadow: var(--shadow-tooltip);
  }

  /* Custom Border Radius Utilities */
  .rounded-10 {
    border-radius: 0.625rem;
  }
  .rounded-20 {
    border-radius: 1.25rem;
  }

  /* Modal Scroll Lock Utilities */
  .modal-open {
    overflow: hidden;
    height: 100vh;
  }
  
  .modal-open body {
    overflow: hidden;
    position: fixed;
    width: 100%;
    height: 100%;
  }

  /* Universal Icon Button Class - Dark mode compatible */
  .btn-icon {
    @apply relative flex items-center justify-center w-8 h-8 p-1 rounded-lg border;
    @apply bg-bg-white-0 border-stroke-soft-200 text-text-soft-400;
    @apply transition-all duration-200 active:scale-95;
    @apply focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary active:border-primary;
  }

  .btn-icon svg {
    @apply text-text-soft-400 focus:text-primary active:text-primary;
  }

  /* Increase hit area for touch without changing visual size */
  .btn-icon::after {
    content: "";
    position: absolute;
    /* Expand by 8px on all sides: 32px + 16px = 48px touch target */
    inset: -8px;
    border-radius: inherit;
    background: transparent;
    pointer-events: auto;
  }

  /* Reusable large touch target utility */
  .tap-target-lg {
    position: relative;
  }
  .tap-target-lg::after {
    content: "";
    position: absolute;
    inset: -8px; /* 16px expansion â†’ 48px total if base is 32px */
    border-radius: inherit;
    background: transparent;
    pointer-events: auto;
  }

  /* ============================================
   * Status Badge Variants - Dark mode compatible
   * Used in: WorkCard, MyWork, Uploading, WorkDashboard
   * Uses semantic tokens with alpha backgrounds for dark mode
   * ============================================ */
  .badge-pill {
    @apply inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full border text-xs font-medium;
    @apply border-stroke-soft-200 text-text-sub-600;
  }

  .badge-pill-blue {
    @apply inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full border text-xs font-medium;
    @apply bg-information-lighter text-information-dark border-information-light;
  }

  .badge-pill-amber {
    @apply inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full border text-xs font-medium;
    @apply bg-warning-lighter text-warning-dark border-warning-light;
  }

  .badge-pill-green {
    @apply inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full border text-xs font-medium;
    @apply bg-success-lighter text-success-dark border-success-light;
  }

  .badge-pill-red {
    @apply inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full border text-xs font-medium;
    @apply bg-error-lighter text-error-dark border-error-light;
  }

  .badge-pill-purple {
    @apply inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full border text-xs font-medium;
    @apply bg-feature-lighter text-feature-dark border-feature-light;
  }

  .badge-pill-slate {
    @apply inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full border text-xs font-medium;
    @apply bg-bg-soft-200 text-text-sub-600 border-stroke-soft-200;
  }

  .badge-pill-emerald {
    @apply inline-flex items-center gap-1 px-1.5 py-0.5 rounded-full border text-xs font-medium;
    @apply bg-success-lighter text-success-dark border-success-light;
  }

  /* ============================================
   * Native Popover Styles
   * Per web.dev/learn/css/popover-and-dialog
   * ============================================ */
  
  /* Base popover styles - hidden by default */
  [popover] {
    border: none;
    padding: 0;
    box-shadow: var(--shadow-tooltip);
  }

  /* Popover open state with animation */
  [popover]:popover-open {
    opacity: 1;
    transform: scale(1);
    
    /* Enable discrete animation for display property */
    transition: 
      opacity 0.2s ease-out,
      transform 0.2s ease-out,
      overlay 0.2s allow-discrete,
      display 0.2s allow-discrete;
  }

  /* Starting styles for popover animation */
  @starting-style {
    [popover]:popover-open {
      opacity: 0;
      transform: scale(0.95);
    }
  }

  /* Closing animation */
  [popover] {
    opacity: 0;
    transform: scale(0.95);
    
    transition: 
      opacity 0.2s ease-in,
      transform 0.2s ease-in,
      overlay 0.2s allow-discrete,
      display 0.2s allow-discrete;
  }

  /* Backdrop styles for auto popovers */
  [popover]::backdrop {
    background: rgba(0, 0, 0, 0.2);
    backdrop-filter: blur(4px);
  }

  [popover]:popover-open::backdrop {
    opacity: 1;
    transition: 
      opacity 0.2s ease-out,
      overlay 0.2s allow-discrete,
      display 0.2s allow-discrete;
  }

  @starting-style {
    [popover]:popover-open::backdrop {
      opacity: 0;
    }
  }

  /* ============================================
   * Content Visibility - Skip rendering off-screen items
   * Uses content-visibility: auto (Baseline Sept 2024)
   * @see https://web.dev/articles/content-visibility
   * ============================================ */

  /* Generic content-visibility for list items */
  .cv-auto {
    content-visibility: auto;
  }

  /* Work card list items (~100px height) */
  .cv-work-card {
    content-visibility: auto;
    contain-intrinsic-size: auto 100px;
  }

  /* Garden card list items (~180px height) */
  .cv-garden-card {
    content-visibility: auto;
    contain-intrinsic-size: auto 180px;
  }

  /* Draft card list items (~80px height) */
  .cv-draft-card {
    content-visibility: auto;
    contain-intrinsic-size: auto 80px;
  }

  /* Notification items (~60px height) */
  .cv-notification {
    content-visibility: auto;
    contain-intrinsic-size: auto 60px;
  }

  /* Member/gardener list items (~56px height) */
  .cv-member {
    content-visibility: auto;
    contain-intrinsic-size: auto 56px;
  }

}